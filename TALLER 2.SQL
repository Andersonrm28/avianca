--------------------- TALLER 2 --------------------------
--A) CREAR CAMPO ESTADO_AERONAVE

ALTER TABLE AERONAVES
  ADD ESTADO_AERONAVE VARCHAR2(255) CHECK (ESTADO_AERONAVE IN ('Vuelo','Tierra','Mantenimiento', 'Reparaci√≥n'));
  
UPDATE AERONAVES SET ESTADO_AERONAVE = 'Tierra';
  
alter table AERONAVES modify ESTADO_AERONAVE not null;
  
--B) CREAR CAMPO AEROPUETO_ACTUAL_ID

ALTER TABLE AERONAVES
  ADD AEROPUETO_ACTUAL_ID INTEGER;
  
  UPDATE AERONAVES SET AEROPUETO_ACTUAL_ID = 1002;
  
ALTER TABLE AERONAVES 
    ADD CONSTRAINT FK_AERONAVES_AERO_ACTUAL FOREIGN KEY (AEROPUETO_ACTUAL_ID) REFERENCES AEROPUERTOS(ID);
    
    
--C) CREAR CAMPO ESTADO_VUELO

ALTER TABLE PROGRAMACIONES
  ADD ESTADO_PROGRAMACION VARCHAR2(255) CHECK (ESTADO_PROGRAMACION IN ('En Vuelo','Cancelado','Retrasado','Confirmado','Abordando','Programado'));
  
  UPDATE PROGRAMACIONES SET ESTADO_PROGRAMACION = 'Confirmado';
  
  ALTER TABLE PROGRAMACIONES MODIFY ESTADO_PROGRAMACION not null;
  
  --PUNTO 5
  --Consulto los vuelos programados desde hoy hasta luego de 2 smanas ingresando aeropuerto origen, destino y el rango de la fecha.
CREATE OR REPLACE VIEW VUELOS_PROGRAMADOS_2SEMANAS AS
    SELECT V.DESCRIPCION, P.FECHA, P.HORA_ESTIMADA_SALIDA
    FROM RUTAS R INNER JOIN VUELOS V ON R.ID = V.RUTAS_ID
                 INNER JOIN PROGRAMACIONES P ON V.ID = P.VUELO_ID
    WHERE R.AEROPUERTO_ORIGEN_ID = 1002 AND R.AEROPUERTO_DESTINO_ID = 1014 AND P.FECHA BETWEEN SYSDATE AND SYSDATE + 14;
